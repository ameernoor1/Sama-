<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬Ø±Ø¨ Ø­Ø¸Ùƒ - Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(45deg, #7c3aed, #2563eb, #3b82f6);
            background-size: 200% 200%;
            animation: gradientBG 10s ease infinite;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .number-container {
            font-size: 3.5rem;
            font-weight: bold;
            text-align: center;
            color: #7c3aed;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .spin-button {
            background: linear-gradient(45deg, #7c3aed, #2563eb);
            background-size: 200% 200%;
            animation: gradientBG 5s ease infinite;
            color: white;
            padding: 1.25rem 2.5rem;
            border-radius: 9999px;
            font-size: 1.5rem;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .spin-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .spin-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .whatsapp-button {
            background-color: #25D366;
            color: white;
            padding: 1.25rem 2.5rem;
            border-radius: 9999px;
            font-size: 1.5rem;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            display: none;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
        }

        .whatsapp-button:hover {
            background-color: #128C7E;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 1.5rem;
            padding: 2.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            max-width: 28rem;
            width: 90%;
            margin: 2rem auto;
            transform: translateY(0);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.3);
        }

        .rolling {
            animation: rollNumber 0.2s linear infinite;
        }

        @keyframes rollNumber {
            0% { transform: translateY(-100%) scale(0.9); opacity: 0; }
            100% { transform: translateY(0) scale(1); opacity: 1; }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1.5rem;
            max-width: 90%;
            width: 500px;
            text-align: center;
            position: relative;
            animation: modalShow 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        @keyframes modalShow {
            from { transform: scale(0.9) translateY(20px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .success-message {
            color: white;
            text-align: center;
            margin-top: 2rem;
            opacity: 0;
            transition: all 0.5s ease;
            transform: translateY(20px);
        }

        .success-message.show {
            opacity: 1;
            transform: translateY(0);
        }

        .timer-container {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 2rem auto;
        }

        .timer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: #7c3aed;
            font-weight: bold;
        }

        .timer-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(#7c3aed var(--progress), #e5e7eb 0deg);
            animation: rotate 1s linear infinite;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes rotate {
            from { --progress: 0deg; }
            to { --progress: 360deg; }
        }

        #videoContainer {
            width: 100%;
            max-height: 300px;
            overflow: hidden;
            border-radius: 1rem;
            margin: 1rem 0;
        }

        video {
            width: 100%;
            height: auto;
            border-radius: 1rem;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-8 flex flex-col items-center justify-center min-h-screen">
        <div class="text-center mb-8 animate__animated animate__fadeIn">
            <h1 class="text-5xl font-bold text-white mb-4 animate__animated animate__bounceIn">Ø¬Ø±Ø¨ Ø­Ø¸Ùƒ Ø§Ù„ÙŠÙˆÙ…! ğŸ€</h1>
            <p class="text-2xl text-white">Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± ÙˆØ§ÙƒØªØ´Ù Ø±Ù‚Ù…Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²</p>
        </div>

        <div class="card animate__animated animate__zoomIn">
            <div class="number-container" id="numberDisplay">
                Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„Ù„Ø¨Ø¯Ø¡
            </div>

            <button class="spin-button" id="spinButton" onclick="spinWheel()">
                Ø¬Ø±Ø¨ Ø­Ø¸Ùƒ!
            </button>

            <button class="whatsapp-button" id="whatsappButton" onclick="shareToWhatsApp()">
                Ø´Ø§Ø±Ùƒ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
            </button>
        </div>

        <div class="success-message" id="successMessage">
            <h2 class="text-3xl font-bold mb-2 animate__animated animate__bounceIn">ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ğŸ‰</h2>
            <p class="text-xl animate__animated animate__fadeIn">Ù‡Ø°Ø§ Ù‡Ùˆ Ø±Ù‚Ù…Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²! ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ø±ÙƒØªÙ‡ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</p>
        </div>
    </div>

    <!-- Modal for Ad -->
    <div class="modal" id="adModal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4 animate__animated animate__fadeInDown">Ù„ØªØ¬Ø±Ø¨Ø© Ø­Ø¸Ùƒ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</h2>
            <p class="mb-4 text-gray-600 animate__animated animate__fadeIn">ÙŠØ±Ø¬Ù‰ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
            
            <div class="timer-container">
                <div class="timer-circle"></div>
                <div class="timer pulse" id="adTimer">10</div>
            </div>

            <div id="videoContainer" class="animate__animated animate__fadeIn">
                <video id="adVideo" controls>
                    <source src="https://firebasestorage.googleapis.com/v0/b/messageemeapp.appspot.com/o/stories%2FHOLIDAY%202022_1730846211263.mp4?alt=media&token=8fde02be-ebf4-463e-9a31-1abab16b9705" type="video/mp4">
                    Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
                </video>
            </div>
        </div>
    </div>

    <audio id="tickSound" preload="auto">
        <source src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3" type="audio/mpeg">
    </audio>

    <audio id="completeSound" preload="auto">
        <source src="https://assets.mixkit.co/active_storage/sfx/2570/2570-preview.mp3" type="audio/mpeg">
    </audio>

    <script>
        const numbers = [
            '123456', '234567', '345678', '456789', '567890',
            '678901', '789012', '890123', '901234', '012345'
        ];

        let isSpinning = false;
        let selectedNumber = null;
        let attempts = 0;
        let canTry = true;
        const numberDisplay = document.getElementById('numberDisplay');
        const spinButton = document.getElementById('spinButton');
        const whatsappButton = document.getElementById('whatsappButton');
        const successMessage = document.getElementById('successMessage');
        const adModal = document.getElementById('adModal');
        const adTimer = document.getElementById('adTimer');
        const adVideo = document.getElementById('adVideo');
        const tickSound = document.getElementById('tickSound');
        const completeSound = document.getElementById('completeSound');
        let spinInterval;

        // Initialize attempts from localStorage
        if (localStorage.getItem('attempts')) {
            attempts = parseInt(localStorage.getItem('attempts'));
            if (attempts > 1) { // Allow first try for free
                canTry = false;
            }
        }

        function spinWheel() {
            if (isSpinning || !canTry) {
                if (!canTry) {
                    showAd();
                }
                return;
            }
            
            attempts++;
            localStorage.setItem('attempts', attempts);
            if (attempts > 1) {
                canTry = false;
            }
            
            isSpinning = true;
            spinButton.disabled = true;
            spinButton.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±...';
            whatsappButton.style.display = 'none';
            successMessage.classList.remove('show');
            numberDisplay.classList.add('rolling');

            let duration = 3000;
            let startTime = Date.now();
            
            spinInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const progress = elapsed / duration;
                
                if (progress >= 1) {
                    clearInterval(spinInterval);
                    finishSpin();
                } else {
                    const randomIndex = Math.floor(Math.random() * numbers.length);
                    numberDisplay.textContent = numbers[randomIndex];
                    tickSound.currentTime = 0;
                    tickSound.play();
                }
            }, 50);
        }

        function finishSpin() {
            isSpinning = false;
            spinButton.disabled = false;
            spinButton.textContent = 'Ø¬Ø±Ø¨ Ø­Ø¸Ùƒ!';
            
            const finalIndex = Math.floor(Math.random() * numbers.length);
            selectedNumber = numbers[finalIndex];
            numberDisplay.textContent = selectedNumber;
            numberDisplay.classList.remove('rolling');
            
            whatsappButton.style.display = 'block';
            successMessage.classList.add('show');
            completeSound.play();
        }

        function showAd() {
            adModal.style.display = 'flex';
            adVideo.play();
            let timeLeft = 10;
            
            const timerInterval = setInterval(() => {
                timeLeft--;
                adTimer.textContent = timeLeft;
                document.documentElement.style.setProperty('--progress', `${(timeLeft/10)*360}deg`);
                
                if (timeLeft > 0) {
                    tickSound.currentTime = 0;
                    tickSound.play();
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    adTimer.textContent = 'ØªÙ…!';
                    completeSound.play();
                    setTimeout(() => {
                        hideAd();
                        canTry = true;
                        attempts = 1; // Reset to 1 to maintain the "first try free" logic
                        localStorage.setItem('attempts', attempts);
                    }, 1000);
                }
            }, 1000);

            adVideo.onended = function() {
                if (timeLeft <= 0) {
                    hideAd();
                    canTry = true;
                    attempts = 1;
                    localStorage.setItem('attempts', attempts);
                }
            };
        }

        function hideAd() {
            adModal.style.display = 'none';
            adVideo.pause();
            adVideo.currentTime = 0;
            }

        function shareToWhatsApp() {
            const message = `Ù…Ø±Ø­Ø¨Ø§Ù‹! Ù‡Ø°Ø§ Ù‡Ùˆ Ø±Ù‚Ù…ÙŠ Ø§Ù„Ù…Ù…ÙŠØ²: ${selectedNumber} ğŸ€\nØ¬Ø±Ø¨ Ø­Ø¸Ùƒ Ø£Ù†Øª Ø£ÙŠØ¶Ø§Ù‹! ğŸ®`;
            const whatsappUrl = `https://wa.me/9647813798636?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª ØµÙˆØªÙŠØ© Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù…Ø§ÙˆØ³ ÙÙˆÙ‚ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        spinButton.addEventListener('mouseover', () => {
            tickSound.currentTime = 0;
            tickSound.volume = 0.3;
            tickSound.play();
        });

        whatsappButton.addEventListener('mouseover', () => {
            tickSound.currentTime = 0;
            tickSound.volume = 0.3;
            tickSound.play();
        });

        // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        adVideo.addEventListener('play', () => {
            adVideo.classList.add('animate__animated', 'animate__fadeIn');
        });

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø«Ø±Ø§Øª Ù„Ù„Ø¹Ø¯Ø§Ø¯
        function updateTimerAnimation(timeLeft) {
            const progress = (timeLeft / 10) * 100;
            const timerCircle = document.querySelector('.timer-circle');
            timerCircle.style.background = `conic-gradient(
                #7c3aed ${progress}%,
                #e5e7eb ${progress}%
            )`;
        }

        // ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        adModal.addEventListener('click', (e) => {
            if (e.target === adModal) {
                // Ù„Ø§ Ù†ØºÙ„Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ Ù„Ø¶Ù…Ø§Ù† Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                adModal.classList.add('animate__animated', 'animate__shakeX');
                setTimeout(() => {
                    adModal.classList.remove('animate__animated', 'animate__shakeX');
                }, 1000);
            }
        });

        // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.addEventListener('load', () => {
            // ØªØ­Ù…ÙŠÙ„ Ù…Ø³Ø¨Ù‚ Ù„Ù„Ø£ØµÙˆØ§Øª
            tickSound.load();
            completeSound.load();
            
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¸Ù‡ÙˆØ± ØªØ¯Ø±ÙŠØ¬ÙŠ Ù„Ù„ØµÙØ­Ø©
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 1s ease';
                document.body.style.opacity = '1';
            }, 100);
        });

        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
        function addNumberAnimation() {
            numberDisplay.classList.add('animate__animated', 'animate__bounceIn');
            setTimeout(() => {
                numberDisplay.classList.remove('animate__animated', 'animate__bounceIn');
            }, 1000);
        }

        // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
        function checkMobileDevice() {
            if (window.innerWidth <= 768) {
                // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
                numberDisplay.style.fontSize = '2.5rem';
                spinButton.style.fontSize = '1.2rem';
                whatsappButton.style.fontSize = '1.2rem';
            }
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø«Ø±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù†Ø¬Ø§Ø­
        function showSuccessEffects() {
            // Ø¥Ø¶Ø§ÙØ© Confetti Ø¹Ù†Ø¯ Ø§Ù„ÙÙˆØ²
            const colors = ['#7c3aed', '#2563eb', '#3b82f6', '#60a5fa'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                confetti.style.opacity = Math.random();
                document.body.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 5000);
            }
        }

        // ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function optimizePerformance() {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ø«Ø±Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¦Ù‡Ø§
            document.querySelectorAll('.animate__animated').forEach(element => {
                element.addEventListener('animationend', () => {
                    element.classList.remove('animate__animated');
                });
            });
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        window.addEventListener('DOMContentLoaded', () => {
            checkMobileDevice();
            optimizePerformance();
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø¤Ø«Ø±Ø§Øª CSS Ù„Ù„ØµÙØ­Ø©
            const style = document.createElement('style');
            style.textContent = `
                @keyframes confetti {
                    0% { transform: translateY(-100vh) rotate(0deg); }
                    100% { transform: translateY(100vh) rotate(360deg); }
                }
                .confetti {
                    position: fixed;
                    width: 10px;
                    height: 10px;
                    z-index: 1000;
                    animation: confetti linear forwards;
                    pointer-events: none;
                }
            `;
            document.head.appendChild(style);
        });

        // Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù…
        function checkDarkMode() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode');
            }
        }

        // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
        window.addEventListener('offline', () => {
            alert('ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¨Ø§Ù„Ù„Ø¹Ø¨');
        });

        // Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
        function cacheGameAssets() {
            if ('caches' in window) {
                caches.open('game-assets').then(cache => {
                    cache.addAll([
                        'https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3',
                        'https://assets.mixkit.co/active_storage/sfx/2570/2570-preview.mp3'
                    ]);
                });
            }
        }

        // ØªØ´ØºÙŠÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­Ø³ÙŠÙ†
        checkDarkMode();
        cacheGameAssets();
    </script>
</body>
</html>